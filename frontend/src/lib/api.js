import { getToken } from './auth';
const API_BASE_URL = import.meta.env.VITE_API_URL || "https://m18eg6bei9.execute-api.us-east-1.amazonaws.com/prod";
/**
 * Make an authenticated API request
 */
async function apiRequest(url, options = {}) {
    const token = await getToken();
    const headers = {
        'Content-Type': 'application/json',
        ...options.headers,
    };
    if (token) {
        headers['Authorization'] = `Bearer ${token}`;
    }
    const response = await fetch(url, {
        ...options,
        headers,
    });
    // Handle 401/403 - token might be expired
    if (response.status === 401 || response.status === 403) {
        // Clear invalid token
        localStorage.removeItem('cognito_id_token');
        throw new Error('Authentication required. Please log in again.');
    }
    return response;
}
export async function uploadEssay(essayText) {
    const response = await apiRequest(`${API_BASE_URL}/essay`, {
        method: "POST",
        body: JSON.stringify({ essay_text: essayText }),
    });
    if (!response.ok) {
        throw new Error(`Failed to upload essay: ${response.statusText}`);
    }
    return response.json();
}
export async function getEssay(essayId) {
    const response = await apiRequest(`${API_BASE_URL}/essay/${essayId}`);
    if (!response.ok) {
        if (response.status === 404) {
            throw new Error("Essay not found");
        }
        throw new Error(`Failed to fetch essay: ${response.statusText}`);
    }
    return response.json();
}
export async function checkHealth() {
    const response = await fetch(`${API_BASE_URL}/health`);
    if (!response.ok) {
        throw new Error("Health check failed");
    }
    return response.json();
}
/**
 * Check auth health (requires authentication)
 */
export async function checkAuthHealth() {
    const response = await apiRequest(`${API_BASE_URL}/auth/health`);
    if (!response.ok) {
        throw new Error("Auth health check failed");
    }
    return response.json();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFFbEMsTUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxJQUFJLDZEQUE2RCxDQUFDO0FBRW5IOztHQUVHO0FBQ0gsS0FBSyxVQUFVLFVBQVUsQ0FBQyxHQUFXLEVBQUUsVUFBdUIsRUFBRTtJQUM5RCxNQUFNLEtBQUssR0FBRyxNQUFNLFFBQVEsRUFBRSxDQUFDO0lBRS9CLE1BQU0sT0FBTyxHQUEyQjtRQUN0QyxjQUFjLEVBQUUsa0JBQWtCO1FBQ2xDLEdBQUksT0FBTyxDQUFDLE9BQWtDO0tBQy9DLENBQUM7SUFFRixJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ1YsT0FBTyxDQUFDLGVBQWUsQ0FBQyxHQUFHLFVBQVUsS0FBSyxFQUFFLENBQUM7SUFDL0MsQ0FBQztJQUVELE1BQU0sUUFBUSxHQUFHLE1BQU0sS0FBSyxDQUFDLEdBQUcsRUFBRTtRQUNoQyxHQUFHLE9BQU87UUFDVixPQUFPO0tBQ1IsQ0FBQyxDQUFDO0lBRUgsMENBQTBDO0lBQzFDLElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxHQUFHLElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxHQUFHLEVBQUUsQ0FBQztRQUN2RCxzQkFBc0I7UUFDdEIsWUFBWSxDQUFDLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQzVDLE1BQU0sSUFBSSxLQUFLLENBQUMsK0NBQStDLENBQUMsQ0FBQztJQUNuRSxDQUFDO0lBRUQsT0FBTyxRQUFRLENBQUM7QUFDbEIsQ0FBQztBQTJCRCxNQUFNLENBQUMsS0FBSyxVQUFVLFdBQVcsQ0FBQyxTQUFpQjtJQUNqRCxNQUFNLFFBQVEsR0FBRyxNQUFNLFVBQVUsQ0FBQyxHQUFHLFlBQVksUUFBUSxFQUFFO1FBQ3pELE1BQU0sRUFBRSxNQUFNO1FBQ2QsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLENBQUM7S0FDaEQsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNqQixNQUFNLElBQUksS0FBSyxDQUFDLDJCQUEyQixRQUFRLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQztJQUNwRSxDQUFDO0lBRUQsT0FBTyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDekIsQ0FBQztBQUVELE1BQU0sQ0FBQyxLQUFLLFVBQVUsUUFBUSxDQUFDLE9BQWU7SUFDNUMsTUFBTSxRQUFRLEdBQUcsTUFBTSxVQUFVLENBQUMsR0FBRyxZQUFZLFVBQVUsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUV0RSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ2pCLElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxHQUFHLEVBQUUsQ0FBQztZQUM1QixNQUFNLElBQUksS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDckMsQ0FBQztRQUNELE1BQU0sSUFBSSxLQUFLLENBQUMsMEJBQTBCLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDO0lBQ25FLENBQUM7SUFFRCxPQUFPLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUN6QixDQUFDO0FBRUQsTUFBTSxDQUFDLEtBQUssVUFBVSxXQUFXO0lBQy9CLE1BQU0sUUFBUSxHQUFHLE1BQU0sS0FBSyxDQUFDLEdBQUcsWUFBWSxTQUFTLENBQUMsQ0FBQztJQUN2RCxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ2pCLE1BQU0sSUFBSSxLQUFLLENBQUMscUJBQXFCLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBQ0QsT0FBTyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDekIsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxDQUFDLEtBQUssVUFBVSxlQUFlO0lBTW5DLE1BQU0sUUFBUSxHQUFHLE1BQU0sVUFBVSxDQUFDLEdBQUcsWUFBWSxjQUFjLENBQUMsQ0FBQztJQUNqRSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ2pCLE1BQU0sSUFBSSxLQUFLLENBQUMsMEJBQTBCLENBQUMsQ0FBQztJQUM5QyxDQUFDO0lBQ0QsT0FBTyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDekIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnLi9hdXRoJztcblxuY29uc3QgQVBJX0JBU0VfVVJMID0gaW1wb3J0Lm1ldGEuZW52LlZJVEVfQVBJX1VSTCB8fCBcImh0dHBzOi8vbTE4ZWc2YmVpOS5leGVjdXRlLWFwaS51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS9wcm9kXCI7XG5cbi8qKlxuICogTWFrZSBhbiBhdXRoZW50aWNhdGVkIEFQSSByZXF1ZXN0XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGFwaVJlcXVlc3QodXJsOiBzdHJpbmcsIG9wdGlvbnM6IFJlcXVlc3RJbml0ID0ge30pOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIGNvbnN0IHRva2VuID0gYXdhaXQgZ2V0VG9rZW4oKTtcbiAgXG4gIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAuLi4ob3B0aW9ucy5oZWFkZXJzIGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz4pLFxuICB9O1xuXG4gIGlmICh0b2tlbikge1xuICAgIGhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICB9XG5cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAuLi5vcHRpb25zLFxuICAgIGhlYWRlcnMsXG4gIH0pO1xuXG4gIC8vIEhhbmRsZSA0MDEvNDAzIC0gdG9rZW4gbWlnaHQgYmUgZXhwaXJlZFxuICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEgfHwgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcbiAgICAvLyBDbGVhciBpbnZhbGlkIHRva2VuXG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2NvZ25pdG9faWRfdG9rZW4nKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkLiBQbGVhc2UgbG9nIGluIGFnYWluLicpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3BvbnNlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVzc2F5UmVzcG9uc2Uge1xuICBlc3NheV9pZDogc3RyaW5nO1xuICBzdGF0dXM6IFwiYXdhaXRpbmdfcHJvY2Vzc2luZ1wiIHwgXCJwcm9jZXNzaW5nXCIgfCBcInByb2Nlc3NlZFwiO1xuICBmaWxlX2tleT86IHN0cmluZztcbiAgcHJlc2lnbmVkX3VybD86IHN0cmluZztcbiAgZXhwaXJlc19pbj86IG51bWJlcjtcbiAgbWV0cmljcz86IHtcbiAgICB3b3JkX2NvdW50OiBudW1iZXI7XG4gICAgdW5pcXVlX3dvcmRzOiBudW1iZXI7XG4gICAgdHlwZV90b2tlbl9yYXRpbzogbnVtYmVyO1xuICAgIG5vdW5fcmF0aW8/OiBudW1iZXI7XG4gICAgdmVyYl9yYXRpbz86IG51bWJlcjtcbiAgICBhZGpfcmF0aW8/OiBudW1iZXI7XG4gICAgYWR2X3JhdGlvPzogbnVtYmVyO1xuICAgIGF2Z193b3JkX2ZyZXFfcmFuaz86IG51bWJlcjtcbiAgfTtcbiAgZmVlZGJhY2s/OiBBcnJheTx7XG4gICAgd29yZDogc3RyaW5nO1xuICAgIGNvcnJlY3Q6IGJvb2xlYW47XG4gICAgY29tbWVudDogc3RyaW5nO1xuICB9PjtcbiAgY3JlYXRlZF9hdD86IHN0cmluZztcbiAgdXBkYXRlZF9hdD86IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwbG9hZEVzc2F5KGVzc2F5VGV4dDogc3RyaW5nKTogUHJvbWlzZTxFc3NheVJlc3BvbnNlPiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpUmVxdWVzdChgJHtBUElfQkFTRV9VUkx9L2Vzc2F5YCwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBlc3NheV90ZXh0OiBlc3NheVRleHQgfSksXG4gIH0pO1xuXG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byB1cGxvYWQgZXNzYXk6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgfVxuXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFc3NheShlc3NheUlkOiBzdHJpbmcpOiBQcm9taXNlPEVzc2F5UmVzcG9uc2U+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KGAke0FQSV9CQVNFX1VSTH0vZXNzYXkvJHtlc3NheUlkfWApO1xuXG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkVzc2F5IG5vdCBmb3VuZFwiKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggZXNzYXk6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgfVxuXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0hlYWx0aCgpOiBQcm9taXNlPHsgc3RhdHVzOiBzdHJpbmcgfT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0FQSV9CQVNFX1VSTH0vaGVhbHRoYCk7XG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJIZWFsdGggY2hlY2sgZmFpbGVkXCIpO1xuICB9XG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbi8qKlxuICogQ2hlY2sgYXV0aCBoZWFsdGggKHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tBdXRoSGVhbHRoKCk6IFByb21pc2U8e1xuICBzdGF0dXM6IHN0cmluZztcbiAgdGVhY2hlcl9pZDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xuICBuYW1lPzogc3RyaW5nO1xufT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaVJlcXVlc3QoYCR7QVBJX0JBU0VfVVJMfS9hdXRoL2hlYWx0aGApO1xuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQXV0aCBoZWFsdGggY2hlY2sgZmFpbGVkXCIpO1xuICB9XG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbiJdfQ==